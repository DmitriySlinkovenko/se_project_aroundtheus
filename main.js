!function(){"use strict";var e=class{constructor(e,t){this._form=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}},t=class{constructor(e,t,s,i,n){this._name=e.name,this._link=e.link,this._templateSelector=t,this._handleImageClick=s,this._handleDeleteButton=i,this._id=e._id,this._handleLike=n,this._isLiked=e.isLiked}_setEventListeners(){this._likeButton=this._element.querySelector(".card__like-button"),this._deleteButton=this._element.querySelector(".card__remove-button"),this._likeButton.addEventListener("click",(()=>this._handleLike(this))),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteButton(this.getId(),this._element)})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick(this._name,this._link)}))}getId(){return this._id}setIsLiked(e){this._isLiked=e,this._renderLikes()}isLiked(){return this._isLiked}_renderLikes(){this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}_getTemplate(){return document.querySelector(this._templateSelector).content.firstElementChild.cloneNode(!0)}generateCard(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__image"),this._cardTitle=this._element.querySelector(".card__title"),this._cardImage.src=this._link,this._cardTitle.textContent=this._name,this._cardImage.alt=this._name,this._setEventListeners(),this._renderLikes(),this._element}};const s=document.querySelector(".profile__edit-button"),i=document.querySelector(".profile__add-button"),n=document.querySelector("#avatar-edit"),r=(document.querySelector("#input__image_title"),document.querySelector("#input__image_link"),document.querySelector("#profile-submit__form")),o=document.querySelector("#image-submit__form"),a=document.querySelector("#avatar-edit-form"),l=document.querySelector("#verification-form"),c={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__save-button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"};class h{constructor(e){this._modalElement=document.querySelector(e)}open(){this._modalElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscapeClose)}close(){this._modalElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscapeClose)}_handleEscapeClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._modalElement.querySelector(".modal__close-button").addEventListener("click",(()=>{this.close()})),this._modalElement.addEventListener("click",(e=>{e.target.classList.contains("modal_opened")&&this.close()}))}}class d extends h{constructor(e,t){super(e),this._modalForm=this._modalElement.querySelector(".form"),this._handleFormSubmit=t,this._inputList=this._modalElement.querySelectorAll(".form__input"),this._submitButton=this._modalForm.querySelector(".form__save-button")}_getInputValues(){const e={};return this._inputList.forEach((t=>{let{name:s,value:i}=t;e[s]=i})),e}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:"Save"}setEventListeners(){super.setEventListeners(),this._modalElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()}))}}const u=new class{constructor(e){let{profileName:t,profileDescription:s,profileAvatar:i}=e;this._profileName=document.querySelector(t),this._profileDescription=document.querySelector(s),this._avatar=document.querySelector(i)}getUserInfo(){return this._user={name:this._profileName.textContent,about:this._profileDescription.textContent},this._user}setUserInfo(e){let{name:t,about:s}=e;this._profileName.textContent=t,this._profileDescription.textContent=s}setAvatar(e){this._avatar.src=e}}({profileName:".profile__title",profileDescription:".profile__subtitle",profileAvatar:".profile__avatar"}),_=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._url=t,this._header=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this._url}/cards`,{headers:this._header}).then((e=>this._checkResponse(e)))}getUserInfo(){return fetch(`${this._url}/users/me`,{headers:this._header}).then((e=>this._checkResponse(e)))}updateUserProfile(e){let{name:t,about:s}=e;return fetch(`${this._url}/users/me`,{method:"PATCH",headers:this._header,body:JSON.stringify({name:`${t}`,about:`${s}`})}).then((e=>this._checkResponse(e)))}updateAvatar(e){let{link:t}=e;return fetch(`${this._url}/users/me/avatar`,{method:"PATCH",headers:this._header,body:JSON.stringify({avatar:`${t}`})}).then((e=>this._checkResponse(e)))}addCard(e){let{name:t,link:s}=e;return fetch(`${this._url}/cards`,{method:"POST",headers:this._header,body:JSON.stringify({name:t,link:s})}).then((e=>this._checkResponse(e)))}deleteCard(e){return fetch(`${this._url}/cards/${e}`,{method:"DELETE",headers:this._header}).then((e=>this._checkResponse(e)))}likeCard(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"PUT",headers:this._header}).then((e=>this._checkResponse(e)))}dislikeCard(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"DELETE",headers:this._header}).then((e=>this._checkResponse(e)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"6e2733e6-8f97-40f4-b18f-c832cf63bc4b","Content-Type":"application/json"}}),m=new class extends h{constructor(e){super(e),this._imageElement=this._modalElement.querySelector(".modal__card-preview_image"),this._imageTitle=this._modalElement.querySelector(".modal__preview_heading")}open(e){this._imageElement.src=e.link,this._imageTitle.textContent=e.name,this._imageElement.alt=e.name,super.open()}}("#preview-image-modal");m.setEventListeners();const p=(e,t)=>{m.open({name:e,link:t})},v=new d("#edit__modal",(function(e){let{name:t,about:s}=e;v.setLoading(!0),_.updateUserProfile({name:t,about:s}).then((()=>{u.setUserInfo({name:t,about:s})})).then((()=>{v.setLoading(!1),v.close()})).catch((e=>{console.error(e)}))}));v.setEventListeners(),s.addEventListener("click",(()=>{v.open();const e=u.getUserInfo();v.setInputValues(e),C.resetValidation()}));const f=new d("#avatar-change-modal",(function(e){let{link:t}=e;f.setLoading(!0),_.updateAvatar({link:t}).then((()=>{u.setAvatar(t)})).then((()=>{f.setLoading(!1),f.close()})).catch((e=>{console.error(e)}))}));f.setEventListeners(),n.addEventListener("click",(()=>{f.open()})),_.getUserInfo().then((e=>{u.setUserInfo(e),u.setAvatar(e.avatar)})).catch((e=>{console.error(e)}));const k=new d("#add-card__modal",(function(e){k.setLoading(!0,"Saving..."),_.addCard(e).then((()=>{y(e)})).then((()=>{k.setLoading(!1),o.reset(),I.resetValidation(),k.close()})).catch((e=>{console.error(e)}))}));function E(e){e.isLiked()?_.dislikeCard(e._id).then((t=>e.setIsLiked(t.isLiked))).catch((e=>console.error(e))):_.likeCard(e._id).then((t=>e.setIsLiked(t.isLiked))).catch((e=>console.error(e)))}k.setEventListeners(),i.addEventListener("click",(()=>{k.open()}));const L=new class extends h{constructor(e,t){super(e),this._modalForm=this._modalElement.querySelector(".form"),this._handleCardDelete=t,this._submitButton=this._modalForm.querySelector(".form__save-button")}setEventListeners(){super.setEventListeners(),this._modalElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleCardDelete(this)}))}setLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:"Save"}}("#verification-modal",g);function g(e,t){L.open(),l.addEventListener("submit",(()=>{L.setLoading(!0,"Deleting..."),_.deleteCard(e).then((()=>t.remove())).then((()=>{L.setLoading(!1),L.close()})).catch((e=>{console.error(e)}))}))}L.setEventListeners();const b=new class{constructor(e,t){let{items:s,renderer:i}=e;this._items=s,this._renderer=i,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>this._renderer(e)))}addItem(e){this._container.append(e)}}({items:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:e=>{const t=S(e);b.addItem(t)}},".elements");function S(e){return new t(e,"#card-template",p,g,E).generateCard()}function y(e){const t=S(e);b.addItem(t)}_.getInitialCards().then((e=>{e.forEach((e=>{y(e)}))})).catch((e=>{console.error(e)}));const C=new e(c,r),I=new e(c,o),w=new e(c,a);C.enableValidation(),I.enableValidation(),w.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEdBQy9CWCxFQUFZUyxRQUFRRyxFQUFZLEdBR3BDLGFBZUYsU0FBU0MsRUFBV3BKLEdBUWxCLE9BUGEsSUFBSXFKLEVBQ2ZySixFQUNBLGlCQUNBRSxFQUNBbUksRUFDQUwsR0FFVXBHLGNBQ2QsQ0FFQSxTQUFTa0csRUFBVzlILEdBQ2xCLE1BQU02SCxFQUFPdUIsRUFBV3BKLEdBQ3hCdUksRUFBWVMsUUFBUW5CLEVBQ3RCLENBMUJBekMsRUFDR1ksa0JBQ0FFLE1BQU0rQixJQUNMQSxFQUFTeEksU0FBU2lHLElBQ2hCb0MsRUFBV3BDLEVBQUksR0FDZixJQUVIMEIsT0FBT0MsSUFDTkMsUUFBUUMsTUFBTUYsRUFBSSxJQXNCdEIsTUFBTUssRUFBdUIsSUFBSTRCLEVBQy9COUIsRUFDQUEsR0FFSU8sRUFBd0IsSUFBSXVCLEVBQ2hDOUIsRUFDQUEsR0FFSStCLEVBQXNCLElBQUlELEVBQzlCOUIsRUFDQUEsR0FFRkUsRUFBcUIvSCxtQkFDckJvSSxFQUFzQnBJLG1CQUN0QjRKLEVBQW9CNUosa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL2NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Nb2RhbC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Nb2RhbFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvTW9kYWxXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvTW9kYWxXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcclxuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpIHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiAhdGhpcy5faW5wdXRFbHMuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcclxuIiwiY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBkYXRhLFxyXG4gICAgdGVtcGxhdGVTZWxlY3RvcixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVCdXR0b24sXHJcbiAgICBoYW5kbGVMaWtlXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX3RlbXBsYXRlU2VsZWN0b3IgPSB0ZW1wbGF0ZVNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b24gPSBoYW5kbGVEZWxldGVCdXR0b247XHJcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZSA9IGhhbmRsZUxpa2U7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gZGF0YS5pc0xpa2VkO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19yZW1vdmUtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlTGlrZSh0aGlzKSk7XHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uKHRoaXMuZ2V0SWQoKSwgdGhpcy5fZWxlbWVudCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRJZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pZDtcclxuICB9XHJcblxyXG4gIHNldElzTGlrZWQoaXNMaWtlZCkge1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGlzTGlrZWQ7XHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xyXG4gIH1cclxuXHJcbiAgaXNMaWtlZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pc0xpa2VkO1xyXG4gIH1cclxuXHJcbiAgX3JlbmRlckxpa2VzKCkge1xyXG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xyXG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbi8vQnV0dG9uc1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCB1c2VyQXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItZWRpdFwiKTtcclxuXHJcbi8vIElucHV0c1xyXG5leHBvcnQgY29uc3QgaW1hZ2VUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaW5wdXRfX2ltYWdlX3RpdGxlXCIpO1xyXG5leHBvcnQgY29uc3QgaW1hZ2VMaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbnB1dF9faW1hZ2VfbGlua1wiKTtcclxuXHJcbi8vIEZvcm0gc3VibWl0c1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUZvcm1TdWJtaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGUtc3VibWl0X19mb3JtXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IGltYWdlU3VibWl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaW1hZ2Utc3VibWl0X19mb3JtXCIpO1xyXG5leHBvcnQgY29uc3QgYXZhdGFyU3VibWl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLWVkaXQtZm9ybVwiKTtcclxuZXhwb3J0IGNvbnN0IGRlbGV0ZUNvbmZpcm1Gb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN2ZXJpZmljYXRpb24tZm9ybVwiKTtcclxuXHJcbi8vIEZvcm0gVmFsaWRhdGlvblxyXG5leHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIuZm9ybV9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuZm9ybV9fc2F2ZS1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImZvcm1fX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJmb3JtX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJmb3JtX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3Rvcihtb2RhbCkge1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihtb2RhbCk7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NhcGVDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjYXBlQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY2FwZUNsb3NlID0gKGUpID0+IHtcclxuICAgIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBjb25zdCBidXR0b24gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpO1xyXG4gICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuLi9jb21wb25lbnRzL01vZGFsXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhGb3JtIGV4dGVuZHMgTW9kYWwge1xyXG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKG1vZGFsU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fbW9kYWxGb3JtID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybV9faW5wdXRcIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9tb2RhbEZvcm0ucXVlcnlTZWxlY3RvcihcIi5mb3JtX19zYXZlLWJ1dHRvblwiKTtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0RGF0YSA9IHt9O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKHsgbmFtZSwgdmFsdWUgfSkgPT4ge1xyXG4gICAgICBpbnB1dERhdGFbbmFtZV0gPSB2YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGlucHV0RGF0YTtcclxuICB9XHJcblxyXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldExvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvY2FyZC5qc1wiO1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgKiBhcyBjb25zdGFudHMgZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgTW9kYWxXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvTW9kYWxXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IE1vZGFsV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvTW9kYWxXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgTW9kYWxXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL01vZGFsV2l0aENvbmZpcm1hdGlvbi5qc1wiO1xyXG5cclxuLy8gVXNlciBJbmZvXHJcbmNvbnN0IHVzZXIgPSBuZXcgVXNlckluZm8oe1xyXG4gIHByb2ZpbGVOYW1lOiBcIi5wcm9maWxlX190aXRsZVwiLFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbjogXCIucHJvZmlsZV9fc3VidGl0bGVcIixcclxuICBwcm9maWxlQXZhdGFyOiBcIi5wcm9maWxlX19hdmF0YXJcIixcclxufSk7XHJcblxyXG4vLyBBUElcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjZlMjczM2U2LThmOTctNDBmNC1iMThmLWM4MzJjZjYzYmM0YlwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG4vL0ltYWdlIFByZXZpZXdcclxuY29uc3QgaW1hZ2VQcmV2aWV3ID0gbmV3IE1vZGFsV2l0aEltYWdlKFwiI3ByZXZpZXctaW1hZ2UtbW9kYWxcIik7XHJcbmltYWdlUHJldmlldy5zZXRFdmVudExpc3RlbmVycygpO1xyXG5jb25zdCBoYW5kbGVJbWFnZUNsaWNrID0gKG5hbWUsIGxpbmspID0+IHtcclxuICBpbWFnZVByZXZpZXcub3Blbih7IG5hbWUsIGxpbmsgfSk7XHJcbn07XHJcblxyXG4vLyBFZGl0IHByb2ZpbGUgbW9kYWxcclxuY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IG5ldyBNb2RhbFdpdGhGb3JtKFxyXG4gIFwiI2VkaXRfX21vZGFsXCIsXHJcbiAgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXRcclxuKTtcclxucHJvZmlsZUVkaXRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5jb25zdGFudHMucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBwcm9maWxlRWRpdE1vZGFsLm9wZW4oKTtcclxuICBjb25zdCB1c2VySW5mbyA9IHVzZXIuZ2V0VXNlckluZm8oKTtcclxuICBwcm9maWxlRWRpdE1vZGFsLnNldElucHV0VmFsdWVzKHVzZXJJbmZvKTtcclxuICBwcm9maWxlRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxufSk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCh7IG5hbWUsIGFib3V0IH0pIHtcclxuICBwcm9maWxlRWRpdE1vZGFsLnNldExvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAudXBkYXRlVXNlclByb2ZpbGUoeyBuYW1lLCBhYm91dCB9KVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICB1c2VyLnNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSk7XHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBwcm9maWxlRWRpdE1vZGFsLnNldExvYWRpbmcoZmFsc2UpO1xyXG4gICAgICBwcm9maWxlRWRpdE1vZGFsLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vVXNlciBhdmF0YXJcclxuY29uc3QgYXZhdGFyRWRpdE1vZGFsID0gbmV3IE1vZGFsV2l0aEZvcm0oXHJcbiAgXCIjYXZhdGFyLWNoYW5nZS1tb2RhbFwiLFxyXG4gIGhhbmRsZUF2YXRhclN1Ym1pdFxyXG4pO1xyXG5hdmF0YXJFZGl0TW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuY29uc3RhbnRzLnVzZXJBdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhdmF0YXJFZGl0TW9kYWwub3BlbigpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdCh7IGxpbmsgfSkge1xyXG4gIGF2YXRhckVkaXRNb2RhbC5zZXRMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZUF2YXRhcih7IGxpbmsgfSlcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgdXNlci5zZXRBdmF0YXIobGluayk7XHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBhdmF0YXJFZGl0TW9kYWwuc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgICAgIGF2YXRhckVkaXRNb2RhbC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5hcGlcclxuICAuZ2V0VXNlckluZm8oKVxyXG4gIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICB1c2VyLnNldFVzZXJJbmZvKGRhdGEpO1xyXG4gICAgdXNlci5zZXRBdmF0YXIoZGF0YS5hdmF0YXIpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICB9KTtcclxuXHJcbi8vIEFkZCBuZXcgY2FyZCBtb2RhbFxyXG5jb25zdCBhZGROZXdDYXJkTW9kYWwgPSBuZXcgTW9kYWxXaXRoRm9ybShcclxuICBcIiNhZGQtY2FyZF9fbW9kYWxcIixcclxuICBoYW5kbGVJbWFnZVN1Ym1pdFxyXG4pO1xyXG5cclxuYWRkTmV3Q2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmNvbnN0YW50cy5hZGROZXdDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYWRkTmV3Q2FyZE1vZGFsLm9wZW4oKTtcclxufSk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVJbWFnZVN1Ym1pdChjYXJkKSB7XHJcbiAgYWRkTmV3Q2FyZE1vZGFsLnNldExvYWRpbmcodHJ1ZSwgXCJTYXZpbmcuLi5cIik7XHJcbiAgYXBpXHJcbiAgICAuYWRkQ2FyZChjYXJkKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICByZW5kZXJDYXJkKGNhcmQpO1xyXG4gICAgfSlcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgYWRkTmV3Q2FyZE1vZGFsLnNldExvYWRpbmcoZmFsc2UpO1xyXG4gICAgICBjb25zdGFudHMuaW1hZ2VTdWJtaXRGb3JtLnJlc2V0KCk7XHJcbiAgICAgIGFkZEltYWdlRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICAgICAgYWRkTmV3Q2FyZE1vZGFsLmNsb3NlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vQ2FyZCBsaWtlICYmIGRpc2xpa2VcclxuXHJcbmZ1bmN0aW9uIGxpa2VCdXR0b24oY2FyZCkge1xyXG4gIGlmIChjYXJkLmlzTGlrZWQoKSkge1xyXG4gICAgYXBpXHJcbiAgICAgIC5kaXNsaWtlQ2FyZChjYXJkLl9pZClcclxuICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiBjYXJkLnNldElzTGlrZWQocmVzcG9uc2UuaXNMaWtlZCkpXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBhcGlcclxuICAgICAgLmxpa2VDYXJkKGNhcmQuX2lkKVxyXG4gICAgICAudGhlbigocmVzcG9uc2UpID0+IGNhcmQuc2V0SXNMaWtlZChyZXNwb25zZS5pc0xpa2VkKSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XHJcbiAgfVxyXG59XHJcblxyXG4vL0RlbGV0ZSBjYXJkIGNvbmZpcm1hdGlvbiBtb2RhbFxyXG5cclxuY29uc3QgY29uZmlybWF0aW9uTW9kYWwgPSBuZXcgTW9kYWxXaXRoQ29uZmlybWF0aW9uKFxyXG4gIFwiI3ZlcmlmaWNhdGlvbi1tb2RhbFwiLFxyXG4gIGhhbmRsZURlbGV0ZUNhcmRGb3JtXHJcbik7XHJcbmNvbmZpcm1hdGlvbk1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkRm9ybShpZCwgZWxlbWVudCkge1xyXG4gIGNvbmZpcm1hdGlvbk1vZGFsLm9wZW4oKTtcclxuICBjb25zdGFudHMuZGVsZXRlQ29uZmlybUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoKSA9PiB7XHJcbiAgICBjb25maXJtYXRpb25Nb2RhbC5zZXRMb2FkaW5nKHRydWUsIFwiRGVsZXRpbmcuLi5cIik7XHJcbiAgICBhcGlcclxuICAgICAgLmRlbGV0ZUNhcmQoaWQpXHJcbiAgICAgIC50aGVuKCgpID0+IGVsZW1lbnQucmVtb3ZlKCkpXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBjb25maXJtYXRpb25Nb2RhbC5zZXRMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgICBjb25maXJtYXRpb25Nb2RhbC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vU2VjdGlvblxyXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIGl0ZW1zOiBjb25zdGFudHMuaW5pdGlhbENhcmRzLFxyXG4gICAgcmVuZGVyZXI6IChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xyXG4gICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuICAgIH0sXHJcbiAgfSxcclxuICBcIi5lbGVtZW50c1wiXHJcbik7XHJcblxyXG5hcGlcclxuICAuZ2V0SW5pdGlhbENhcmRzKClcclxuICAudGhlbigocmVzcG9uc2UpID0+IHtcclxuICAgIHJlc3BvbnNlLmZvckVhY2goKHJlcykgPT4ge1xyXG4gICAgICByZW5kZXJDYXJkKHJlcyk7XHJcbiAgICB9KTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgfSk7XHJcblxyXG4vLyBGdW5jdGlvbnNcclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChkYXRhKSB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgZGF0YSxcclxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDYXJkRm9ybSxcclxuICAgIGxpa2VCdXR0b25cclxuICApO1xyXG4gIHJldHVybiBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW5kZXJDYXJkKGRhdGEpIHtcclxuICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChkYXRhKTtcclxuICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmQpO1xyXG59XHJcblxyXG4vLyBGb3JtIFZhbGlkYXRpb25cclxuXHJcbmNvbnN0IHByb2ZpbGVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgY29uc3RhbnRzLnNldHRpbmdzLFxyXG4gIGNvbnN0YW50cy5wcm9maWxlRm9ybVN1Ym1pdFxyXG4pO1xyXG5jb25zdCBhZGRJbWFnZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBjb25zdGFudHMuc2V0dGluZ3MsXHJcbiAgY29uc3RhbnRzLmltYWdlU3VibWl0Rm9ybVxyXG4pO1xyXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgY29uc3RhbnRzLnNldHRpbmdzLFxyXG4gIGNvbnN0YW50cy5hdmF0YXJTdWJtaXRGb3JtXHJcbik7XHJcbnByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYWRkSW1hZ2VGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IHByb2ZpbGVOYW1lLCBwcm9maWxlRGVzY3JpcHRpb24sIHByb2ZpbGVBdmF0YXIgfSkge1xyXG4gICAgdGhpcy5fcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVOYW1lKTtcclxuICAgIHRoaXMuX3Byb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZURlc2NyaXB0aW9uKTtcclxuICAgIHRoaXMuX2F2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZUF2YXRhcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHRoaXMuX3VzZXIgPSB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50LFxyXG4gICAgICBhYm91dDogdGhpcy5fcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50LFxyXG4gICAgfTtcclxuICAgIHJldHVybiB0aGlzLl91c2VyO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9wcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBhYm91dDtcclxuICB9XHJcblxyXG4gIHNldEF2YXRhcihhdmF0YXIpIHtcclxuICAgIHRoaXMuX2F2YXRhci5zcmMgPSBhdmF0YXI7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX3VybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXIgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHNgLCB7IGhlYWRlcnM6IHRoaXMuX2hlYWRlciB9KS50aGVuKChyZXMpID0+XHJcbiAgICAgIHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7IGhlYWRlcnM6IHRoaXMuX2hlYWRlciB9KS50aGVuKFxyXG4gICAgICAocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcylcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVVc2VyUHJvZmlsZSh7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogYCR7bmFtZX1gLFxyXG4gICAgICAgIGFib3V0OiBgJHthYm91dH1gLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUF2YXRhcih7IGxpbmsgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyOiBgJHtsaW5rfWAsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgbGluazogbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGlkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXIsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XHJcbiAgfVxyXG5cclxuICBsaWtlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xyXG4gIH1cclxuXHJcbiAgZGlzbGlrZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcixcclxuICAgIH0pLnRoZW4oKHJlcykgPT4gdGhpcy5fY2hlY2tSZXNwb25zZShyZXMpKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhJbWFnZSBleHRlbmRzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihtb2RhbFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2ltYWdlRWxlbWVudCA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5tb2RhbF9fY2FyZC1wcmV2aWV3X2ltYWdlXCJcclxuICAgICk7XHJcbiAgICB0aGlzLl9pbWFnZVRpdGxlID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLm1vZGFsX19wcmV2aWV3X2hlYWRpbmdcIlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIG9wZW4oZGF0YSkge1xyXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LnNyYyA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2ltYWdlVGl0bGUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWx0ID0gZGF0YS5uYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgTW9kYWwgZnJvbSBcIi4uL2NvbXBvbmVudHMvTW9kYWxcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yLCBoYW5kbGVDYXJkRGVsZXRlKSB7XHJcbiAgICBzdXBlcihtb2RhbFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX21vZGFsRm9ybSA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkRGVsZXRlID0gaGFuZGxlQ2FyZERlbGV0ZTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX21vZGFsRm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX3NhdmUtYnV0dG9uXCIpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVDYXJkRGVsZXRlKHRoaXMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNsYXNzU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihjbGFzc1NlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4gdGhpcy5fcmVuZGVyZXIoaXRlbSkpO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9mb3JtIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2lucHV0RWxzIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJxdWVyeVNlbGVjdG9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImlucHV0RWwiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwiZXJyb3JNZXNzYWdlRWwiLCJpZCIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJyZW1vdmUiLCJfaGFzSW52YWxpZElucHV0IiwiZXZlcnkiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJkaXNhYmxlZCIsIl9zZXRFdmVudExpc3RlbmVycyIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiZW5hYmxlVmFsaWRhdGlvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsImlucHV0RWxlbWVudCIsImRhdGEiLCJ0ZW1wbGF0ZVNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZUJ1dHRvbiIsImhhbmRsZUxpa2UiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfdGVtcGxhdGVTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUJ1dHRvbiIsIl9pZCIsIl9oYW5kbGVMaWtlIiwiX2lzTGlrZWQiLCJpc0xpa2VkIiwiX2xpa2VCdXR0b24iLCJfZWxlbWVudCIsIl9kZWxldGVCdXR0b24iLCJnZXRJZCIsIl9jYXJkSW1hZ2UiLCJzZXRJc0xpa2VkIiwiX3JlbmRlckxpa2VzIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJjb250ZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJjbG9uZU5vZGUiLCJnZW5lcmF0ZUNhcmQiLCJfY2FyZFRpdGxlIiwic3JjIiwiYWx0IiwicHJvZmlsZUVkaXRCdXR0b24iLCJhZGROZXdDYXJkQnV0dG9uIiwidXNlckF2YXRhckJ1dHRvbiIsInByb2ZpbGVGb3JtU3VibWl0IiwiaW1hZ2VTdWJtaXRGb3JtIiwiYXZhdGFyU3VibWl0Rm9ybSIsImRlbGV0ZUNvbmZpcm1Gb3JtIiwiZm9ybVNlbGVjdG9yIiwiTW9kYWwiLCJtb2RhbCIsIl9tb2RhbEVsZW1lbnQiLCJvcGVuIiwiX2hhbmRsZUVzY2FwZUNsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIk1vZGFsV2l0aEZvcm0iLCJtb2RhbFNlbGVjdG9yIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX21vZGFsRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2lucHV0TGlzdCIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0RGF0YSIsIl9yZWYiLCJ2YWx1ZSIsInNldElucHV0VmFsdWVzIiwiaW5wdXQiLCJzZXRMb2FkaW5nIiwiaXNMb2FkaW5nIiwibG9hZGluZ1RleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJ1c2VyIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlQXZhdGFyIiwiX3Byb2ZpbGVOYW1lIiwiX3Byb2ZpbGVEZXNjcmlwdGlvbiIsIl9hdmF0YXIiLCJnZXRVc2VySW5mbyIsIl91c2VyIiwiYWJvdXQiLCJzZXRVc2VySW5mbyIsIl9yZWYyIiwic2V0QXZhdGFyIiwiYXZhdGFyIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfdXJsIiwiX2hlYWRlciIsIl9jaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwidGhlbiIsInVwZGF0ZVVzZXJQcm9maWxlIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1cGRhdGVBdmF0YXIiLCJfcmVmMyIsImFkZENhcmQiLCJfcmVmNCIsImRlbGV0ZUNhcmQiLCJsaWtlQ2FyZCIsImRpc2xpa2VDYXJkIiwiYXV0aG9yaXphdGlvbiIsImltYWdlUHJldmlldyIsIl9pbWFnZUVsZW1lbnQiLCJfaW1hZ2VUaXRsZSIsInByb2ZpbGVFZGl0TW9kYWwiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImNvbnN0YW50cyIsInVzZXJJbmZvIiwicHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJhdmF0YXJFZGl0TW9kYWwiLCJhZGROZXdDYXJkTW9kYWwiLCJjYXJkIiwicmVuZGVyQ2FyZCIsImFkZEltYWdlRm9ybVZhbGlkYXRvciIsImxpa2VCdXR0b24iLCJyZXNwb25zZSIsImNvbmZpcm1hdGlvbk1vZGFsIiwiaGFuZGxlQ2FyZERlbGV0ZSIsIl9oYW5kbGVDYXJkRGVsZXRlIiwiaGFuZGxlRGVsZXRlQ2FyZEZvcm0iLCJlbGVtZW50IiwiY2FyZFNlY3Rpb24iLCJjbGFzc1NlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwiYXBwZW5kIiwiY2FyZERhdGEiLCJjYXJkRWxlbWVudCIsImNyZWF0ZUNhcmQiLCJDYXJkIiwiRm9ybVZhbGlkYXRvciIsImF2YXRhckZvcm1WYWxpZGF0b3IiXSwic291cmNlUm9vdCI6IiJ9